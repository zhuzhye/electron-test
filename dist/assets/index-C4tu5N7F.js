import{_ as w}from"./_plugin-vue_export-helper-CtXoblKC.js";import{_ as y}from"./logo-C4A_ETkD.js";import{h}from"./index-7wIT0JMu.js";import{u as k,i as d,q as I,l as T,d as v,a7 as S,a8 as p,a9 as x,a0 as L,c as _,e as t,g as b,f as D,w as E,k as m,o as f,A as M,B as R,aa as C}from"./index-CBdA0cQS.js";const U=""+new URL("ytx-DgKbqHLE.png",import.meta.url).href,$=e=>h.request({url:"/dingDingLogin",method:"GET",params:e},{successMessageText:"登录成功",errorMessageText:"登录失败"}),q=()=>h.request({url:"/userInfo",method:"GET"},{errorMessageText:"获取用户信息失败"}),A=(e,o)=>{const s=k();let n=d(!1);return I(()=>{window.DTFrameLogin({id:"login_container",width:300,height:300},{redirect_uri:encodeURIComponent(e.value),client_id:o.value,scope:"openid",response_type:"code",state:"STATE",prompt:"consent"},async a=>{n.value=!0;const{authCode:i,callback:l}=a;console.log(l,"callback");const r=T(),c=await $({authCode:i});c.code===200&&c.data.token?(sessionStorage.setItem("token",c.data.token),r.setToken(c.data.token),s.push("/monitor/tsServices"),window.removeEventListener("message",l)):(s.push("/login"),window.location.reload());const g=await q();g.data&&r.setUserInfo(g.data),n.value=!1},a=>{console.log(`Login Error: ${a}`)})}),{spinning:n}},B=v({name:"Motion",props:{delay:{type:Number,default:50}},render(){const{delay:e}=this,o=S("motion");if(!o)return console.error("v-motion directive is not defined. Make sure it is registered correctly."),p("div",{},this.$slots.default?this.$slots.default():[]);const s=this.$slots.default?this.$slots.default():[];return x(p("div",{},{default:()=>s}),[[o,{initial:{opacity:0,y:150},enter:{opacity:1,y:0,transition:{delay:e}}}]])}}),u=e=>(M("data-v-c195f0c3"),e=e(),R(),e),N={class:"login-body"},V=u(()=>t("img",{src:y,alt:""},null,-1)),F={class:"QRdingding"},G=u(()=>t("div",{class:"dingText"},[t("img",{class:"ytxImg",src:U,alt:""}),t("span",null,"使用钉钉扫码")],-1)),P=u(()=>t("div",{id:"login_container"},null,-1)),H=[P],K=v({__name:"index",setup(e){const o=d("dingnxsxidanep0b3uwx"),s=d(window.location.origin+"/#/login");let n=d(!1);L(async()=>{let{spinning:i}=A(s,o);n.value=i.value});const a=async()=>{let i=await window.myAPI.readFileTree();console.log(i),alert(window.myAPI.version)};return(i,l)=>{const r=C;return f(),_("div",N,[t("div",{class:"login-header"},[V,t("button",{id:"serverbtn",onClick:a},"xxxxxxxxxxx"),b(" 服务监控平台 ")]),D(m(B),{delay:150},{default:E(()=>[t("div",F,[G,x((f(),_("div",null,H)),[[r,m(n)]])])]),_:1})])}}}),O=w(K,[["__scopeId","data-v-c195f0c3"]]);export{O as default};
