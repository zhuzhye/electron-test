(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25804b66"],{"0ace":function(e,t,a){},"19b2":function(e,t,a){},2360:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"font-family":"PingFangSC-Regular, PingFang SC"}},[t("a-row",[t("a-col",{attrs:{span:16}},[t("div",{staticClass:"map"},[t("map-model")],1),t("div",{staticClass:"video-box"},[t("video-model")],1)]),t("a-col",{attrs:{span:8}},[t("div",{staticClass:"table"},[t("div",{staticClass:"title"},[t("span",[e._v("维保统计")]),t("span",{on:{click:function(t){return e.routerTo("/newPms/shipShow/shipMenuCard")}}},[e._v("更多")])]),t("table",[t("tr",[t("td",[e._v("船舶名称")]),t("td",[e._v("工作总数")]),t("td",[e._v("过期工单")]),t("td",[e._v("本月到期")]),t("td",[e._v("本月完成")])])]),t("div",{staticClass:"tbody"},[t("table",e._l(e.workTotalList,(function(a){return t("tr",{key:a.shipId},[t("td",[e._v(e._s(a.shipName))]),t("td",[e._v(e._s(a.workOrderTotal))]),t("td",{staticStyle:{color:"rgb(171, 83, 93)"}},[e._v(e._s(a.expiredWorkOrderNum))]),t("td",{staticStyle:{color:"rgb(212, 202, 127)"}},[e._v(" "+e._s(a.currentMonthDueWorkOrderNum)+" ")]),t("td",{staticStyle:{color:"rgb(190, 231, 110)"}},[e._v(" "+e._s(a.currentMonthcompleteWorkOrderNum)+" ")])])})),0)]),0!=e.pages?t("div",{staticClass:"footerPage"},[1!=e.pageNo?t("a-icon",{attrs:{type:"caret-left"},on:{click:function(t){e.pageNo--,e.getWorkTotal()}}}):e._e(),e._v(" "+e._s(e.pageNo)+"/"+e._s(e.pages)+" "),e.pageNo!=e.pages?t("a-icon",{attrs:{type:"caret-right"},on:{click:function(t){e.pageNo++,e.getWorkTotal()}}}):e._e()],1):e._e()]),t("div",{staticClass:"table"},[t("div",{staticClass:"title"},[t("span",[e._v("船舶统计")]),t("div",{staticClass:"tip"},[t("span",{class:1==e.activeType?"active":"",on:{click:function(t){return e.changeActiveType(1)}}},[e._v("船舶证书")]),t("span",{class:2==e.activeType?"active":"",on:{click:function(t){return e.changeActiveType(2)}}},[e._v("船员证书")]),t("span",{class:3==e.activeType?"active":"",on:{click:function(t){return e.changeActiveType(3)}}},[e._v("保险证书")])]),t("span",{on:{click:function(t){return e.routerTo("1"==e.activeType?"/shipymanage/shipData/ShipUploadPage":"2"==e.activeType?"/shipymanage/yyaq/seaman/SeamanUploadList":"/shipymanage/yyaq/insurance/InsuranceUploadPage")}}},[e._v("更多")])]),t("table",[t("tr",[t("td",[e._v(e._s("2"==e.activeType?"船员名称":"船舶名称"))]),t("td",[e._v("证书名称")]),t("td",[e._v("注册日期")]),t("td",[e._v("到期提醒")])])]),t("div",{staticClass:"tbody"},[t("table",e._l(e.certificateList,(function(a){return t("tr",{key:a},[t("td",[e._v(e._s("2"==e.activeType?a.seamanName:a.shipName))]),t("td",[e._v(" "+e._s("3"==e.activeType?a.insureName:a.certificateNameStr)+" ")]),t("td",[e._v(e._s(a.startTime))]),t("td",[e._v(e._s(a.remindTime))])])})),0)]),0!=e.pages1?t("div",{staticClass:"footerPage"},[1!=e.pageNo1?t("a-icon",{attrs:{type:"caret-left"},on:{click:function(t){e.pageNo1--,e.getCertificateList()}}}):e._e(),e._v(" "+e._s(e.pageNo1)+"/"+e._s(e.pages1)+" "),e.pageNo1!=e.pages1?t("a-icon",{attrs:{type:"caret-right"},on:{click:function(t){e.pageNo1++,e.getCertificateList()}}}):e._e()],1):e._e()]),t("div",{staticClass:"table"},[t("div",{staticClass:"title"},[t("span",[e._v("安全提醒")]),t("span")])])])],1),e.urlList.length>0?t("div",{staticClass:"footer"},e._l(e.urlList,(function(a,s){return t("a",{key:s,attrs:{target:"_blank",href:a.linkUrl}},[e._v(e._s(a.linkName))])})),0):e._e()],1)},i=[],r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"newCamera_box"},[t("div",{staticClass:"newCamera_box_left"},[t("div",{staticClass:"tree_box"},[t("a-input-search",{attrs:{placeholder:"请输入搜索的船名"},on:{search:e.onQueryTree},model:{value:e.shipName,callback:function(t){e.shipName=t},expression:"shipName"}}),t("a-tree",{attrs:{"tree-data":e.treeData,blockNode:!0,showIcon:!0,expandedKeys:e.expandedKeys,selectedKeys:e.selectedKeys},on:{select:e.onSelectTreeNode},scopedSlots:e._u([{key:"title",fn:function(s){return[t("div",{staticClass:"tree_box_item"},[s.shipId?e._e():t("div",[e.expandedKeys.indexOf(s.key)>-1||e.expandedKeys.indexOf(s.shipId)>-1?t("img",{staticClass:"tree_box_item_icon",attrs:{src:a("9d7f")}}):t("img",{staticClass:"tree_box_item_icon",attrs:{src:a("35dc")}})]),t("div",{staticStyle:{flex:"1"}},[e._v(e._s(s.title))]),s.shipId?e._e():t("span",{class:"video_canvas_icon "+(e.expandedKeys.indexOf(s.key)>-1||e.expandedKeys.indexOf(s.shipId)>-1?"video_icon_xiangshang":"video_icon_xiangxia"),staticStyle:{"font-size":"12px"}})])]}}])},[t("template",{slot:"switcherIcon"},[t("span")])],2)],1)]),t("div",{staticClass:"newCamera_box_right"},[t("div",{staticClass:"newCamera_top"},[t("span",[e._v("视频监控")]),t("span",{on:{click:function(t){return e.routerTo("/microcamera/camera/newCamera")}}},[e._v("更多")])]),t("div",{staticClass:"newCamera_content"},[t("div",{staticClass:"newCamera_content_box"},[t("div",{staticClass:"newCamera_item newCamera_item_1 newCamera_item_checked",on:{click:function(t){return e.onCheckedVideo()}}},[t("div",{staticClass:"newCamera_item_title"},[e._v(" "+e._s(e.checkedCameraDate?e.checkedCameraDate.shipName+"——"+e.checkedCameraDate.title:"请选择摄像头")+" ")]),t("div",{staticClass:"newCamera_item_content"},[t("div",{staticClass:"newCamera_item_play"},[t("div",{ref:"videoCoverBox",staticClass:"videoCoverBox"},[t("img",{directives:[{name:"show",rawName:"v-show",value:e.checkedCameraDate&&e.checkedCameraDate.lastPicture,expression:"checkedCameraDate && checkedCameraDate.lastPicture"}],attrs:{src:e.checkedCameraDate?e.checkedCameraDate.lastPicture:"none"}})]),t("video",{ref:"videoEle",attrs:{disablePictureInPicture:"true",controlslist:"nodownload noremoteplayback"}}),e.checkedCameraDate&&e.checkedCameraDate.state>0?e._e():t("div",{staticClass:"newCamera_item_wuhuamian_default"},[t("img",{staticStyle:{width:"100%"},attrs:{src:a("3a68")}}),t("p",[e._v("暂无画面")])]),t("a-spin",{staticClass:"newCamera_item_spinning",attrs:{spinning:e.spLoding(e.checkedCameraDate)}},[t("a-icon",{staticStyle:{"font-size":"44px"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1)],1),e.checkedCameraDate?t("div",{staticClass:"newCamera_item_function",style:{display:e.checkedCameraDate&&e.checkedCameraDate.state<1?"block":""}},[t("div",{staticClass:"newCamera_item_fun_bottom"},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[e.checkedCameraDate&&e.checkedCameraDate.state>0?t("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" 暂停 ")]},proxy:!0}],null,!1,4035566819)},[e.checkedCameraDate&&e.checkedCameraDate.state>0?t("a-icon",{staticStyle:{"margin-left":"12px","font-size":"18px"},attrs:{type:"pause-circle"},on:{click:function(t){return e.cameraPause()}}}):e._e()],1):e._e(),e.checkedCameraDate&&0===e.checkedCameraDate.state?t("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" 播放 ")]},proxy:!0}],null,!1,3550317806)},[e.checkedCameraDate&&0===e.checkedCameraDate.state?t("a-icon",{staticStyle:{"margin-left":"12px","font-size":"18px"},attrs:{type:"play-circle"},on:{click:function(t){return e.getCameraM3U8()}}}):e._e()],1):e._e(),e.checkedCameraDate&&e.checkedCameraDate.state>0?t("span",{staticClass:"tips"},[e._v(" 正在直播 ")]):e._e()],1),t("div",[t("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"video_icon_changeQingxidu"},[t("div",{on:{click:function(t){return e.changeQingxidu(1)}}},[e._v("流畅")]),t("div",{on:{click:function(t){return e.changeQingxidu(2)}}},[e._v("标清")]),t("div",{on:{click:function(t){return e.changeQingxidu(3)}}},[e._v("高清")])])]},proxy:!0}],null,!1,3279137615)},[e.checkedCameraDate&&e.checkedCameraDate.state>0?t("span",{staticClass:"video_icon_changeQingxidu"},[e._v(" 清晰度 ")]):e._e()]),t("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" 截图 ")]},proxy:!0}],null,!1,2451961961)},[e.checkedCameraDate&&e.checkedCameraDate.state>1?t("span",{staticClass:"video_canvas_icon video_icon_jietu",on:{click:function(t){return e.cameraCreenshot(e.checkedCameraDate.shipName,e.checkedCameraDate.title)}}}):e._e()])],1)])]):e._e()])])])])])])},n=[],o=(a("14d9"),a("f660")),c=a("c1df"),l=a.n(c);let d=a("ba56");var h={data(){return{urls:{onQueryTree:"/shipCameraService/tbShipCamera/getShipCameraTree",openVideo:"/shipCameraService/tbShipCamera/openVideo",closeVideo:"/shipCameraService/tbShipCamera/closeVideo",keep:"/shipCameraService/tbShipCamera/test/keep",change:"/shipCameraService/tbShipCamera/test/change"},shipName:null,treeData:[],expandedKeys:[],selectedKeys:[],repeatGetTreeId:null,repeatKeepHeartbeatId:null,checkedCameraDate:null,checkedVideo:0,websocketTimeStamp:null,documentHidden:!0}},mounted(){let e=this;e.onQueryTree(),e.repeatGetTreeId=setInterval(()=>{e.onQueryTree()},3e5),e.repeatKeepHeartbeatId=setInterval(()=>{if(e.checkedCameraDate){const t=new FormData;t.append("ids",e.checkedCameraDate.id),e.$axios.post(e.urls.keep,t)}},1e4),e.websocketTimeStamp=Date.parse(new Date);let t="wss://springcloud.intertion.cn/shipCameraService/webCamera"+e.websocketTimeStamp;"WebSocket"in window?(Object(o["a"])(null,"close"),Object(o["a"])(t,"create")):e.$message.warning("您所在浏览器暂不支持webSocket链接，部分功能无法使用！"),window.addEventListener("visibilitychange",e.visibility),window.addEventListener("onmessageWS",e.getsocketData),window.addEventListener("resize",e.calcWhidth),d.isSupported()||e.$message.warning("您所在浏览器暂不支持Hls视频播放功能，请更换浏览器！"),e.createVideoMonitor(),e.calcWhidth()},methods:{onQueryTree(){let e=this;e.$axios.get(e.urls.onQueryTree,{params:{shipName:e.shipName?e.shipName:""}}).then((function(t){e.treeData=t.result}))},onSelectTreeNode(e,t){let a=this;if(a.selectedKeys=[t.node.dataRef.key],!t.node.dataRef.shipId){let e=a.expandedKeys.indexOf(t.node.dataRef.key);return void(-1<e?(a.expandedKeys.splice(e,1),a.selectedKeys[0]===t.node.dataRef.key&&(a.selectedKeys=[])):a.expandedKeys.push(t.node.dataRef.key))}let s=t.node.dataRef;if(a.checkedCameraDate){const{id:e}=a.checkedCameraDate;if(e==s.id)return void this.$message.warning("此摄像头已存在,请选择其他摄像头")}if(a.checkedCameraDate={hls:null,id:s.key,title:s.title,shipId:s.shipId,shipName:s.shipName,state:0,isCameraSuccessPlay:!0,qingxidu:0,lastPicture:null,webSocketImg:0,cameraTimeId:null,interruptRecoveryId:null,videoRepairId:null,limitTenMinId:null},this.checkedCameraDate.id==s.id)return a.$message.warning("此摄像头已存在，请选择其他摄像头！"),!1;a.getCameraM3U8()},getsocketData(e){let t=this,a=JSON.parse(e&&e.detail.data);if(4==a.cmd){if(1==a.data.type){let e=a.data.cameraId;this.checkedCameraDate.id==e&&t.cameraPause()}else if(2==a.data.type){let e=a.data.cameraId;this.checkedCameraDate.id==e&&t.cameraPause()}}else if(5==a.cmd){let e="data:image/png;base64,"+a.buffer.array;this.checkedCameraDate.id==a.cameraId&&1==this.checkedCameraDate.state&&(t.checkedCameraDate.webSocketImg=1,t.checkedCameraDate.lastPicture=e)}else 6==a.cmd&&t.checkedCameraDate.shipId==a.shipId&&(t.cameraPause(),t.$message.warning(a.message))},visibility(){let e=this;e.documentHidden=!document.hidden,e.documentHidden&&e.checkedCameraDate.state>0&&e.$refs.videoEle.play()},createVideoMonitor(){let e=this;e.$nextTick(()=>{let t=e.$refs.videoEle;t.removeEventListener("waiting",e.videoWaiting),t.removeEventListener("playing",e.videoPlaying),t.removeEventListener("play",e.videoPlay),t.removeEventListener("pause",e.videoPause),t.addEventListener("waiting",e.videoWaiting),t.addEventListener("playing",e.videoPlaying),t.addEventListener("play",e.videoPlay),t.addEventListener("pause",e.videoPause)})},videoWaiting(e){let t=this,a=t.$refs.videoCoverBox;a.style.display="block"},videoPlaying(e){let t=this,a=t.saveLastFrame();t.checkedCameraDate.lastPicture=a;let s=t.$refs.videoCoverBox;s.style.display="none",t.checkedCameraDate.webSocketImg=1,t.checkedCameraDate.hls&&(t.$set(t.checkedCameraDate,"state",2),t.$set(t.checkedCameraDate,"isCameraSuccessPlay",!1)),t.checkedCameraDate.cameraTimeId&&(clearTimeout(t.checkedCameraDate.cameraTimeId),t.checkedCameraDate.cameraTimeId=null),t.checkedCameraDate.videoRepairId&&(clearTimeout(t.checkedCameraDate.videoRepairId),t.checkedCameraDate.videoRepairId=null),t.checkedCameraDate.interruptRecoveryId&&(clearTimeout(t.checkedCameraDate.interruptRecoveryId),t.checkedCameraDate.interruptRecoveryId=null)},videoPlay(){},videoPause(e){let t=this,a=t.$refs.videoCoverBox;a.style.display="block",t.checkedCameraDate.state>0&&t.documentHidden&&t.$refs.videoEle.play()},onCheckedVideo(e){let t=this;t.checkedVideo=e},fullScreen(){let e=document.querySelector(".newCamera_content");document.fullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},spLoding(e){return!(!e||!e.state||1!=e.state||0!=e.webSocketImg)},getCameraM3U8(){let e=this,t=this.urls.openVideo,a={id:this.checkedCameraDate.id,random:e.websocketTimeStamp};const s=new FormData;for(const i in a)s.append(i,a[i]);e.$axios.post(t,s).then(t=>{if(500===t.code)return e.$message.warning(t.message),void e.$set(e.checkedCameraDate,"state",0);let a=t.result.plugFlowAddress;e.checkedCameraDate.cameraTimeId&&(clearTimeout(e.checkedCameraDate.cameraTimeId),e.checkedCameraDate.cameraTimeId=null),e.$set(e.checkedCameraDate,"state",1),e.videoBindHls(a),e.addVideoRepair(),14!=t.result.shipType?e.limitVideoTenMin(3e5):e.limitVideoTenMin(6e5)})},videoBindHls(e){let t=this;try{let a=t.$refs.videoEle,s=new d;s.attachMedia(a),s.on(d.Events.MEDIA_ATTACHED,()=>{s.loadSource(e),t.$set(t.checkedCameraDate,"hls",s),s.on(d.Events.MANIFEST_PARSED,(function(){t.$set(t.checkedCameraDate,"state",2),a.play()})),s.on(d.Events.ERROR,(function(e,i){let r=i.type,n=i.fatal;if(t.checkedCameraDate.cameraTimeId&&(clearTimeout(t.checkedCameraDate.cameraTimeId),t.checkedCameraDate.cameraTimeId=null),t.checkedCameraDate.isCameraSuccessPlay)s.destroy(),t.checkedCameraDate.cameraTimeId=setTimeout(()=>{t.checkedCameraDate.state>0&&t.getCameraM3U8()},6e3);else if(t.checkedCameraDate.interruptRecoveryId&&(clearTimeout(t.checkedCameraDate.interruptRecoveryId),t.checkedCameraDate.interruptRecoveryId=null),t.checkedCameraDate.interruptRecoveryId||(t.checkedCameraDate.interruptRecoveryId=setTimeout(()=>{a.play()},1e4)),n)switch(t.$set(t.checkedCameraDate,"state",1),r){case d.ErrorTypes.NETWORK_ERROR:s.startLoad();break;case d.ErrorTypes.MEDIA_ERROR:s.recoverMediaError();break}else r==d.ErrorTypes.MEDIA_ERROR&&(s.recoverMediaError(),s.startLoad())}))})}catch(a){t.checkedCameraDate.cameraTimeId&&(clearTimeout(t.checkedCameraDate.cameraTimeId),t.checkedCameraDate.cameraTimeId=null),t.checkedCameraDate.cameraTimeId=setTimeout(()=>{t.getCameraM3U8()},1e4)}},addVideoRepair(){let e=this;e.checkedCameraDate.videoRepairId||(e.checkedCameraDate.videoRepairId=setTimeout(()=>{e.checkedCameraDate.isCameraSuccessPlay?(e.checkedCameraDate.cameraTimeId&&(clearTimeout(e.checkedCameraDate.cameraTimeId),e.checkedCameraDate.cameraTimeId=null),e.checkedCameraDate.hls&&(e.checkedCameraDate.hls.destroy(),e.checkedCameraDate.hls=null),e.checkedCameraDate.isCameraSuccessPlay=!0,e.$set(e.checkedCameraDate,"state",0),e.checkedCameraDate.webSocketImg=0):(clearTimeout(e.checkedCameraDate.videoRepairId),e.checkedCameraDate.videoRepairId=null)},6e4))},limitVideoTenMin(e){let t=this;t.checkedCameraDate.limitTenMinId&&(clearTimeout(t.checkedCameraDate.limitTenMinId),t.checkedCameraDate.limitTenMinId=null),t.checkedCameraDate.limitTenMinId=setTimeout(()=>{t.cameraPause(1)},e)},cameraPause(e){let t=this;return t.checkedCameraDate.cameraTimeId&&(clearTimeout(t.checkedCameraDate.cameraTimeId),t.checkedCameraDate.cameraTimeId=null),t.checkedCameraDate.videoRepairId&&(clearTimeout(t.checkedCameraDate.videoRepairId),t.checkedCameraDate.videoRepairId=null),t.checkedCameraDate.interruptRecoveryId&&(clearTimeout(t.checkedCameraDate.interruptRecoveryId),t.checkedCameraDate.interruptRecoveryId=null),t.checkedCameraDate.limitTenMinId&&(clearTimeout(t.checkedCameraDate.limitTenMinId),t.checkedCameraDate.limitTenMinId=null),new Promise(a=>{let s=document.createElement("canvas"),i=this.$refs.videoEle;if(i&&t.checkedCameraDate.state>0){let e=i.offsetWidth,a=i.offsetHeight;s.width=e,s.height=a,s.getContext("2d").drawImage(i,0,0,e,a),2===t.checkedCameraDate.state&&(t.checkedCameraDate.lastPicture=s.toDataURL("img/png"))}if(t.checkedCameraDate.state>0){const s=new FormData;s.append("id",t.checkedCameraDate.id),s.append("random",t.websocketTimeStamp),s.append("passive",e),t.$axios.post(t.urls.closeVideo,s).then(()=>{let e=t.$refs.videoCoverBox;e&&(e.style.display="block"),t.checkedCameraDate.hls&&(t.checkedCameraDate.hls.destroy(),t.checkedCameraDate.hls=null),t.checkedCameraDate.js=!0,t.checkedCameraDate.state=0,t.checkedCameraDate.webSocketImg=0,a()})}else a()})},changeQingxidu(e){let t=this;t.checkedCameraDate.qingxidu=e;const a=new FormData;a.append("id",t.checkedCameraDate.id),a.append("grade",e),a.append("isHis",2),t.$axios.post(t.urls.change,a).then(e=>{500==e.code?t.$message.error(e.message):200==e.code&&t.$message.success(e.message)})},cameraCreenshot(e,t){let a=this,s=document.createElement("canvas"),i=l()(new Date).format("YYYY-MM-DD HHmmss"),r=a.$refs.videoEle;s.width=1100,s.height=634,s.getContext("2d").drawImage(r,0,0,1100,634);let n=document.createElement("a");n.href=s.toDataURL(),n.setAttribute("download",`${e}-${t} ${i} .png`),n.click()},saveLastFrame(){let e=this,t=document.createElement("canvas"),a=e.$refs.videoEle;return t.width=a.offsetWidth,t.height=a.offsetHeight,t.getContext("2d").drawImage(a,0,0,t.width,t.height),t.toDataURL("img/png")},calcWhidth(){let e=document.querySelector(".newCamera_content"),t=0,a=0,s=0;a=e.offsetWidth-48-32,s=e.offsetHeight-64,t=.5625*a<s?Number.parseInt(a):Number.parseInt(s/.5625);let i=document.querySelector(".newCamera_content_box");i.style.width=t+32+"px"},routerLeave(){let e=this;e.cameraPause(),window.removeEventListener("visibilitychange",e.visibility),window.removeEventListener("onmessageWS",e.getsocketData),window.removeEventListener("resize",e.calcWhidth),e.repeatKeepHeartbeatId&&clearInterval(e.repeatKeepHeartbeatId),e.repeatGetTreeId&&clearInterval(e.repeatGetTreeId),Object(o["a"])(null,"close")}}},p=h,m=(a("4a99"),a("2877")),u=Object(m["a"])(p,r,n,!1,null,"211ef939",null),g=u.exports,v=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"map"}},[t("a-spin",{staticClass:"loading_class",attrs:{spinning:e.spinning,size:"large",tip:"加载中请稍后..."}}),t("Small-Map",{ref:"smallMap",on:{changeMap:e.changeMap}}),t("ship-list-model",{ref:"shipListModel"}),t("ship-info-model",{ref:"shipInfoModel"}),e._m(0),t("div",{attrs:{id:"showShipInfo"}}),t("ship-tips")],1)},f=[function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"mouse_position"}},[t("div",{attrs:{id:"positionLat"}}),t("div",{attrs:{id:"positionLng"}})])}],w=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"smallMap"}},[t("div",{staticClass:"smallMap1",on:{click:function(t){return e.changeMap("haitu")}}},[t("span",[e._v("海图")])]),t("div",{staticClass:"smallMap2",on:{click:function(t){return e.changeMap("weixingtu")}}},[t("span",[e._v("卫星图")])]),t("div",{staticClass:"smallMap3",on:{click:function(t){return e.changeMap("ditu")}}},[t("span",[e._v("地图")])])])},y=[],C={name:"smallMap",data(){return{}},methods:{changeMap(e){this.$emit("changeMap",e)}}},k=C,S=(a("3d9d"),Object(m["a"])(k,w,y,!1,null,"4d20eb92",null)),_=S.exports,b=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"shipListModal"}},[t("div",{staticClass:"search"},[t("input",{ref:"searchInput",attrs:{type:"text",placeholder:"请输入船舶名称/MMSI/IMO"},domProps:{value:e.searchName},on:{input:t=>e.searchShip(t.target.value),focus:e.focus,blur:e.blur}}),t("span",[t("a-icon",{directives:[{name:"show",rawName:"v-show",value:e.showSearchList,expression:"showSearchList"}],attrs:{type:"close-circle"},on:{click:function(t){e.searchName="",e.searchShip()}}})],1),e.showSearchList?t("div",{staticClass:"searchList"},[t("ul",e._l(e.searchShipList,(function(a,s){return t("li",{key:s,on:{click:function(t){return e.getShipInfo(a)}}},[t("span",[e._v(" 船名:"+e._s(a.nameCn)+" ")]),e._v("  "),t("span",[t("code",[e._v(" 呼号:"+e._s(a.callsign))])]),e._v("  "),t("span",[t("code",[e._v(" MMSI:"+e._s(a.mmsi)+" ")])]),e._v("  "),t("span",[t("code",[e._v(" IMO:"+e._s(a.imo)+" ")])])])})),0),e.searchName?e._e():t("p",{on:{click:e.clearList}},[e._v("清空历史记录")])]):e._e()])])},I=[],D=(a("cd17"),a("ed3b")),L=(a("3c65"),a("256f")),T=(a("5bc0"),a("5eee")),x=a("480c"),A=a("a2c7"),M=a("3e6b"),P=a("9c78"),E=a("5831"),F=a("6c77"),N=a("6cbf"),R=a("8295"),O=a("83a6"),$=a("8682"),V=a("ce2c"),z=a("5bc3"),G=a("5ab0"),K=a.n(G),j=a("f403"),U=a("ce75"),W=a.n(U);const H={},B=e=>Object(L["s"])(e,"EPSG:4326","EPSG:3857");H.shipStyle=function(e,t){let a=5e-4,s=null,i=null,r=.514444*parseFloat(e.get("speed")),n=e.get("name"),o=e.get("color"),c=parseFloat(e.get("direction")),l=e.get("geom").getCoordinates(),d=parseFloat(e.get("lon")),h=parseFloat(e.get("lat")),p=e.get("shipType");if(t<13){s=new F["c"]({fill:new O["a"]({color:75===p?"#398AD1":o}),stroke:new $["a"]({color:"#333",width:.5})});let e=B([d,h+(1.8+.2*r)*a]),t=B([d,h+1.8*a]),n=B([d-.4*a,h+a]),m=B([d+.4*a,h+a]),u=B([d-.4*a,h-1.5*a]),g=B([d+.4*a,h-1.5*a]);i=new z["b"]([[e,t,n,u,g,m,t]]),i.rotate(-Math.PI/180*c,l)}else{a=t/13e3,s=new F["c"]({fill:new O["a"]({color:75===p?"#398AD1":o}),stroke:new $["a"]({color:"#333",width:1})});let e=6.5*t;if(75===p){let s=[l[0],l[1]+17*t+e*r*.3],n=B([d,h+1.3*a]),o=B([d-.7*a,h+.7*a]),p=B([d-.7*a,h-a]),m=B([d,h-.4*a]),u=B([d+.7*a,h-a]),g=B([d+.7*a,h+.7*a]);i=new z["b"]([[s,n,o,p,m,u,g,n]]),i.rotate(-Math.PI/180*c,l)}else{let a=[l[0],l[1]+17*t+e*r*.3],s=[l[0],l[1]+3*e],n=[l[0]-e,l[1]-e],o=[l[0]+e,l[1]-e];i=new z["b"]([[a,s,n,o,s]]),i.rotate(-Math.PI/180*c,l)}}e.setProperties({geometry:i},!0);let m=new F["c"]({text:new R["a"]({font:"bold 12px serif",textAlign:"left",overflow:!0,fill:new O["a"]({color:"rgb(90,90,90)"}),stroke:new $["a"]({color:"#fff",width:2}),textBaseline:"bottom",offsetX:0,offsetY:30,text:n?n.replace(/@/g,""):""})}),u=[];return u.push(s),u.push(m),u},H.shipFocusStyle=function(e,t){let a=5e-4,s=null,i=null,r=.514444*parseFloat(e.get("speed")),n=parseFloat(e.get("direction")),o=e.get("geom").getCoordinates(),c=parseFloat(e.get("lon")),l=parseFloat(e.get("lat")),d=e.get("color"),h=e.get("shipType");if(t<13){s=new F["c"]({fill:new O["a"]({color:75===h?"#398AD1":d}),stroke:new $["a"]({color:"#333",width:.5})});let e=B([c,l+(1.8+.2*r)*a]),t=B([c,l+1.8*a]),p=B([c-.4*a,l+a]),m=B([c+.4*a,l+a]),u=B([c-.4*a,l-1.5*a]),g=B([c+.4*a,l-1.5*a]);i=new z["b"]([[e,t,p,u,g,m,t]]),i.rotate(-Math.PI/180*n,o)}else{a=t/13e3,s=new F["c"]({fill:new O["a"]({color:75===h?"#398AD1":d}),stroke:new $["a"]({color:"#333",width:1})});let e=6.5*t;if(75===h){let s=[o[0],o[1]+17*t+e*r*.3],d=B([c,l+1.3*a]),h=B([c-.7*a,l+.7*a]),p=B([c-.7*a,l-a]),m=B([c,l-.4*a]),u=B([c+.7*a,l-a]),g=B([c+.7*a,l+.7*a]);i=new z["b"]([[s,d,h,p,m,u,g,d]]),i.rotate(-Math.PI/180*n,o)}else{let a=[o[0],o[1]+17*t+e*r*.3],s=[o[0],o[1]+3*e],c=[o[0]-e,o[1]-e],l=[o[0]+e,o[1]-e];i=new z["b"]([[a,s,c,l,s]]),i.rotate(-Math.PI/180*n,o)}}return e.setProperties({geometry:i},!0),s},H.searchStyle=function(e,t){let a=null,s=parseFloat(e.get("lon")),i=parseFloat(e.get("lat"));a=new F["c"]({image:new N["a"]({anchor:[.45,.4],src:W.a,rotation:Math.PI/180*e.get("direction")}),text:new R["a"]({text:e.get("name")?e.get("name").replace(/@/g,""):"",font:"bold 12px serif",offsetY:13,offsetX:0,fill:new O["a"]({color:"rgb(90,90,90)"}),stroke:new $["a"]({color:"#fff",width:2})})});let r=new j["a"](Object(L["s"])([s,i],"EPSG:4326","EPSG:3857"));return e.setProperties({geometry:r},!0),a},H.selectStyle=new F["c"]({image:new N["a"]({anchor:[.5,.5],src:K.a})}),H.clickStyle=function(){return function(e,t){let a=5e-4,s=null,i=null,r=.514444*parseFloat(e.get("speed")),n=e.get("name"),o=e.get("color"),c=parseFloat(e.get("direction")),l=e.get("geom").getCoordinates(),d=parseFloat(e.get("lon")),h=parseFloat(e.get("lat")),p=e.get("shipType");if(t<13){s=new F["c"]({stroke:new $["a"]({color:"red",width:1}),fill:new O["a"]({color:o})});let e=B([d,h+(1.8+.2*r)*a]),t=B([d,h+1.8*a]),n=B([d-.4*a,h+a]),p=B([d+.4*a,h+a]),m=B([d-.4*a,h-1.5*a]),u=B([d+.4*a,h-1.5*a]);i=new z["b"]([[e,t,n,m,u,p,t]]),i.rotate(-Math.PI/180*c,l)}else{a=t/13e3,s=new F["c"]({fill:new O["a"]({color:o}),stroke:new $["a"]({color:"#333",width:1})});let e=6.5*t;if(75===p){let s=[l[0],l[1]+17*t+e*r*.3],n=B([d,h+1.3*a]),o=B([d-.7*a,h+.7*a]),p=B([d-.7*a,h-a]),m=B([d,h-.4*a]),u=B([d+.7*a,h-a]),g=B([d+.7*a,h+.7*a]);i=new z["b"]([[s,n,o,p,m,u,g,n]]),i.rotate(-Math.PI/180*c,l)}else{let a=[l[0],l[1]+17*t+e*r*.3],s=[l[0],l[1]+3*e],n=[l[0]-e,l[1]-e],o=[l[0]+e,l[1]-e];i=new z["b"]([[a,s,n,o,s]]),i.rotate(-Math.PI/180*c,l)}}e.setProperties({geometry:i},!0);let m=new F["c"]({text:new R["a"]({font:"bold 12px serif",textAlign:"left",overflow:!0,fill:new O["a"]({color:"rgb(90,90,90)"}),stroke:new $["a"]({color:"#fff",width:3}),textBaseline:"bottom",offsetX:0,offsetY:20,text:n?n.replace(/@/g,""):""})}),u=[];return u.push(s),u.push(m),u}},H.screenClickStyle=function(){return function(e,t){let a=null,s=parseFloat(e.get("lon")),i=parseFloat(e.get("lat"));if(t>13){a=new F["c"]({image:new N["a"]({anchor:[.45,.4],src:W.a,rotation:Math.PI/180*e.get("direction")}),text:new R["a"]({text:e.get("name")?e.get("name").replace(/@/g,""):"",font:"bold 12px serif",offsetY:13,offsetX:0,fill:new O["a"]({color:"rgb(90,90,90)"}),stroke:new $["a"]({color:"#fff",width:2})})});let t=new j["a"](Object(L["s"])([s,i],"EPSG:4326","EPSG:3857"));e.setProperties({geometry:t},!0)}else{a=new F["c"]({text:new R["a"]({text:e.get("name")?e.get("name").replace(/@/g,""):"",font:"bold 12px serif",offsetY:100,offsetX:0,fill:new O["a"]({color:"#00a0e9"}),stroke:new $["a"]({color:"white",width:4})}),fill:new O["a"]({color:"#24FF24"}),stroke:new $["a"]({color:"#24FF24",width:.1})});let t=5e-4,r=[s-.4*t,i-t],n=[s-.4*t,i],o=[s,i+t],c=[s+.4*t,i],l=[s+.4*t,i-t],d=Object(L["s"])(r,"EPSG:4326","EPSG:3857"),h=Object(L["s"])(n,"EPSG:4326","EPSG:3857"),p=Object(L["s"])(o,"EPSG:4326","EPSG:3857"),m=Object(L["s"])(c,"EPSG:4326","EPSG:3857"),u=Object(L["s"])(l,"EPSG:4326","EPSG:3857"),g=new z["b"]([[d,h,p,m,u]]),v=e.get("geom").getCoordinates();g.rotate(-Math.PI/180*e.get("course"),v),e.setProperties({geometry:g},!0)}return a}},H.AGenTingStyle=new F["c"]({stroke:new $["a"]({color:"#FF5454",width:2})}),H.AGenTingStyles=new F["c"]({stroke:new $["a"]({color:"#FF5454",lineDash:[10,10],width:2})}),H.JinYuQuStyle=new F["c"]({fill:new O["a"]({color:"rgba(239,245,133, 0.7)"}),stroke:new $["a"]({color:"red",width:1})}),H.ZXDStyle=new F["c"]({fill:new O["a"]({color:"rgba(239,245,133, 0.5)"}),stroke:new $["a"]({color:"#FF0000",width:1})}),H.ZXDLinestyle=new F["c"]({stroke:new $["a"]({color:"#FF5454",width:2})}),H.Overl=function(e,t){let a=[],s=e.get("type");return"Point"===s?a=new F["c"]({image:new V["a"]({fill:new O["a"]({color:"red"}),radius:3})}):"Circle"===s?a=new F["c"]({fill:new O["a"]({color:"rgba(51,153,204,0)"}),stroke:new $["a"]({color:"rgb(204, 39, 155)",width:2})}):"Line"===s&&(a=new F["c"]({stroke:new $["a"]({color:"#FF5454",width:2})})),a};var Y=H,X=a("2ef16"),q=a("020f"),Q=a("4cdf"),J=a("2ce2"),Z=a("35a7"),ee=a("0710");const te={map:null,view:null,layer:null,shipSource:null,shipSourceStandby:null,shipLayer:null,shipStyle:null,shipClick:null,pathLineSource:null,pathLineLayer:null,pathPointSource:null,pathPointLayer:null,selectSource:null,selectLayer:null,sourceList:[],layerList:[],drawPointSource:null,drawPointLayer:null,drawPointDraw:null,measureTooltipElement:null,measureTooltip:null},ae={};te.view=new A["a"]({projection:"EPSG:3857",center:Object(L["s"])([0,0],"EPSG:4326","EPSG:3857"),zoom:3,minZoom:1,maxZoom:20,constrainResolution:!0,smoothExtentConstraint:!1,extent:Object(L["t"])([-540,-85,540,85],"EPSG:4326","EPSG:3857")}),te.layer=new P["b"]({layers:[new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})}),new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})})]}),te.seaView=new X["a"]({url:"http://haitu.intertion.cn/haitu/ImgService?z={z}&x={x}&y={y}"}),te.seaLayer=new x["a"]({preload:1/0,source:te.seaView,zIndex:1}),te.layer=new P["b"]({layers:[new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})}),new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})})]}),te.sateLayer=new P["b"]({layers:[new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})}),new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})})]}),te.sateLayer=new P["b"]({layers:[new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})}),new x["a"]({source:new X["a"]({crossOrigin:"anonymous",url:"https://t{0-7}.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=32a5cea2cd257f71a7628814e873bd48"})})]}),ae.creatMap=()=>new T["a"]({target:"map",layers:[te.seaLayer,te.layerList.focusLayer,te.layerList.selectLayer],view:te.view,controls:[]}),te.sourceList.selectSource=new E["a"],te.layerList.selectLayer=new M["a"]({source:te.sourceList.selectSource,className:"selectlayer",zIndex:15}),te.sourceList.focusSource=new E["a"],te.shipFocusStyle=function(e,t){return Y.shipStyle(e,t)},te.layerList.focusLayer=new M["a"]({source:te.sourceList.focusSource,style:te.shipFocusStyle,zIndex:7,className:"focusship"}),ae.changeMap=function(e,t){switch(t){case"haitu":e.removeLayer(te.sateLayer),e.removeLayer(te.layer),e.addLayer(te.seaLayer);break;case"weixingtu":e.removeLayer(te.seaLayer),e.removeLayer(te.layer),e.addLayer(te.sateLayer);break;case"ditu":e.removeLayer(te.sateLayer),e.removeLayer(te.seaLayer),e.addLayer(te.layer);break;default:break}},ae.cacuLonLat=function(e,t,a){let s=parseInt(e,10),i=null;"lon"===t?i=e>=0?"E":"W":"lat"===t&&(i=e>=0?"N":"S");let r=(60*(e-s)).toFixed(3);s=Math.abs(s),r=Math.abs(r);let n=[s+"°"+r+"′",i];return a?[s,r,i]:n},ae.stringLonLat=function(e,t){let a=ae.cacuLonLat(e,t);return a[0]+" "+a[1]},ae.addMousePos=function(e){let t=new q["a"]({coordinateFormat:function(e){while(e[0]<-180)e[0]=e[0]+360;while(e[0]>180)e[0]=e[0]-360;let t=ae.stringLonLat(e[0],"lon"),a=ae.stringLonLat(e[1],"lat");return document.getElementById("positionLng").innerHTML=t,document.getElementById("positionLat").innerHTML=a,""},projection:"EPSG:4326"});e.addControl(t)},ae.addShip=e=>{let t=null;for(let a=0;a<e.length;a++){let s=[e[a].posVoList[0].lon/60/1e4,e[a].posVoList[0].lat/60/1e4],i=Object(L["s"])(s,"EPSG:4326","EPSG:3857"),r=new j["a"](i);t=new Q["a"]({geometry:r,type:"ship",shipType:e[a].shipType,direction:e[a].posVoList[0].co?e[a].posVoList[0].co/10:0,lon:e[a].posVoList[0].lon/60/1e4,lat:e[a].posVoList[0].lat/60/1e4,speed:e[a].posVoList[0].sp?e[a].posVoList[0].sp/10:0,name:e[a].name,shipId:e[a].sid,time:e[a].posVoList[0].pt,mmsi:e[a].mmsi,color:"1"===e[a].shipAisType?"lawngreen":"2"===e[a].shipAisType?"orange":"#38499d",center:i,shipAisType:e[a].shipAisType}),t.setId(e[a].sid),t.set("geom",r),te.sourceList.focusSource.addFeature(t)}},ae.changeColor=e=>{const t=te.sourceList.focusSource.getFeatureById(e);t.set("color","orange")},ae.addClick=(e,t)=>{te.shipClick=new J["a"]({layers:[te.layerList.focusLayer]}),te.shipClick.on("select",(function(a){let s=a.selected[0];ae.addSelect(s.get("shipId"),e),s&&(s.setStyle(Y.shipStyle),t.$refs.shipInfoModel.showShipInfoModel=!1,t.$refs.shipInfoModel.shipType=s.get("shipAisType"),t.$axios.get("/seachart/tbFleetInfo/getTbFleetInfo",{params:{id:s.get("shipId"),level:2}}).then(e=>{const a=e.result.shipVehicleVo;a?(t.$refs.shipInfoModel.showShipInfoModel=!0,t.$refs.shipInfoModel.shipInfo=a,t.$refs.shipInfoModel.shipAisPos=a.shipAisPos?JSON.parse(a.shipAisPos):{}):t.$message.info("暂无船舶信息")}))})),e.addInteraction(te.shipClick)},ae.claerSource=e=>{te.sourceList[e].clear()},ae.addSelect=(e,t)=>{te.sourceList.selectSource.clear();const a=te.sourceList.focusSource.getFeatureById(e);let s=a.get("geom").getCoordinates(),i=new j["a"](s),r=new Q["a"]({geometry:i});r.setStyle(Y.selectStyle),te.sourceList.selectSource.addFeature(r),t.getView().setCenter(s)},ae.showShipPathMessage=e=>{const t=document.getElementById("showShipInfo"),a=new ee["a"]({element:t});e.on("pointermove",(function(s){const i=e.getFeaturesAtPixel(s.pixel);if(0!==i.length){t.style.display="block",e.getTargetElement().style.cursor=e.hasFeatureAtPixel(s.pixel)?"pointer":"";const r=i[0];let n;"ship"===r.get("type")?n="船名: "+(r.get("name")?r.get("name"):"-")+"<br/>MMSI: "+(r.get("mmsi")?r.get("mmsi"):"-")+"<br/>时间: "+(r.get("time")?r.get("time"):"-")+"<br/>":"historyPoint"===r.get("type")&&(n="经度："+(r.get("lonStr")?r.get("lonStr"):"-")+"<br/>纬度："+(r.get("latStr")?r.get("latStr"):"-")+"<br/>时间："+(r.get("time")?r.get("time"):"-")+"<br/>航速："+(r.get("speed")?r.get("speed")+"节":"-")+"<br/>航向："+(r.get("course")?r.get("course")+"度":"-")+"<br/>"),t.innerHTML=n,a.setPosition(r.get("center")),a.setOffset([10,20]),e.addOverlay(a)}else t.innerHTML="",t.style.display="none",e.removeOverlay(a)}))},ae.addZoomListener=(e,t)=>{te.Listen=e.on("moveend",(function(e){t(e.map.getView().getZoom(),e.map)}))},ae.cancelLisetn=function(){Object(Z["b"])(te.Listen)};var se=ae,ie={name:"shipListModel",components:{},data(){return{shipGroupList:[],leftExpandedKeys:[],leftList:[],followList:[],rightList:[],activeKey:"1",showShipInfoModel:!1,shipIndex:"",searchShipList:[],searchName:"",showSearchList:!1,followShipSearchName:""}},created(){},computed:{},mounted(){sessionStorage.getItem("sessionShipList")&&(this.searchShipList=JSON.parse(sessionStorage.getItem("sessionShipList")))},watch:{searchName(e){e||sessionStorage.getItem("sessionShipList")&&(this.searchShipList=JSON.parse(sessionStorage.getItem("sessionShipList")))}},methods:{focus(){this.showSearchList=!0},blur(){setTimeout(()=>{this.showSearchList=!1},500)},getShip(e,t){this.showShipInfo(e,t),this.sign(e)},sign(e){this.$axios.get("/seachart/CurrentAis/getSingleShipLatestAisData",{params:{vehicleId:e}}).then(t=>{if(t.result&&t.result.shipAisPos){const a=JSON.parse(t.result.shipAisPos)[0].lon/6e5,s=JSON.parse(t.result.shipAisPos)[0].lat/6e5;let i=this.$parent.map;i.getView().setCenter(Object(L["s"])([a,s],"EPSG:4326","EPSG:3857")),i.getView().setZoom(3),se.addSelect(e,i)}})},showShipInfo(e,t){this.$axios.get("/seachart/tbFleetInfo/getTbFleetInfo",{params:{id:e,level:2}}).then(e=>{const a=e.result.shipVehicleVo;a?(this.$parent.$refs.shipInfoModel.shipInfo=a||{},this.$parent.$refs.shipInfoModel.shipAisPos=a&&a.shipAisPos?JSON.parse(a.shipAisPos):{},this.$parent.$refs.shipInfoModel.showShipInfoModel=!0,this.$parent.$refs.shipInfoModel.shipType=t):this.$message.info("暂无船舶信息")})},cancelFollow(e){const t=this;D["a"].confirm({title:"确定取消关注此船舶?",okText:"确定",cancelText:"取消",onOk(){t.$axios.delete("/seachart/tsUserShipFocus/removeUserShipFocusList",{vehicleId:e}).then(e=>{})},onCancel(){}})},searchShip(e){this.searchName=e,this.$axios.get("/interface/vehicle/vehicleSearchByEs",{params:{keyWord:this.searchName}}).then(e=>{e.result.vehicles&&(this.searchShipList=e.result.vehicles)})},clearList(){sessionStorage.removeItem("sessionShipList"),this.searchShipList=[]},getShipInfo(e){if(this.searchName=e.nameCn,sessionStorage.getItem("sessionShipList")){const t=JSON.parse(sessionStorage.getItem("sessionShipList"));t.reverse().forEach((a,s)=>{a.id===e.id&&t.splice(s,1)}),t.unshift(e),t.length>5&&t.pop(),sessionStorage.setItem("sessionShipList",JSON.stringify(t))}else sessionStorage.setItem("sessionShipList",JSON.stringify([e]));this.sign(e.id),this.showShipInfo(e.id,3)}}},re=ie,ne=(a("6fa5"),Object(m["a"])(re,b,I,!1,null,"62560df0",null)),oe=ne.exports,ce=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showShipInfoModel,expression:"showShipInfoModel"}],staticClass:"shipInfoModal"},[t("div",{staticClass:"model"},[t("div",{staticClass:"top"},[t("span",[e._v(" "+e._s(e.shipInfo.name)+" - "+e._s(e.shipInfo.nameEn)+" ")]),t("span",[t("a-icon",{staticStyle:{"font-size":"21px"},attrs:{type:"close"},on:{click:function(t){e.showShipInfoModel=!1}}})],1)]),t("div",{staticClass:"shipInfo-content"},[t("div",{staticClass:"grid"},[t("div",[e._v(" MMSI: "),t("span",[e._v(e._s(e.transformation(e.shipInfo.mmsi)))])]),t("div",[e._v(" 船长(米): "),t("span",[e._v(e._s(e.transformation(e.shipInfo.length)))])]),t("div",[e._v(" 呼号: "),t("span",[e._v(e._s(e.transformation(e.shipInfo.callsign)))])]),t("div",[e._v(" 船宽(米): "),t("span",[e._v(e._s(e.transformation(e.shipInfo.width)))])]),t("div",[e._v(" IMO: "),t("span",[e._v(e._s(e.shipInfo.imo))])]),t("div",[e._v(" 吃水(米): "),t("span",[e._v(e._s(e.transformation(e.shipInfo.draught)))])]),t("div",[e._v(" 类型: "),t("span",[e._v(e._s(e.transformation(e.shipInfo.shipTypeStr)))])]),t("div",[e._v(" 航速(节): "),t("span",[e._v(e._s(e.transformation(e.shipAisPos.sp)))])]),t("div",[e._v(" 状态: "),t("span",[e._v(e._s(e.transformation(e.shipAisPos.ns,"state")))])]),t("div",[e._v(" 纬度: "),t("span",[e._v(e._s(e.transformation(e.shipAisPos.lat,"lat")))])]),t("div",[e._v(" 船艏向(度): "),t("span",[e._v(e._s(e.transformation(e.shipAisPos.hd)))])]),t("div",[e._v(" 经度: "),t("span",[e._v(e._s(e.transformation(e.shipAisPos.lon,"lon")))])]),t("div",[e._v(" 报位时间: "),t("span",[e._v(e._s(e.transformation(e.shipAisPos.pt)))])]),t("div",[e._v(" 更新时间: "),t("span",[e._v(e._s(e.transformation(e.shipAisPos.utime,"time")))])])]),t("img",{attrs:{src:a("ac28"),alt:""}})])])])},le=[],de={data(){return{shipInfo:{},shipAisPos:{},showShipInfoModel:!1,remindList:[],shipType:null}},created(){},mounted(){},computed:{},methods:{addFollow(e){this.axios.$put("/seachart/tsUserShipFocus/addUserShipFocusList",{vehicleId:e}).then(t=>{200===t.code?(this.$message.success(t.messageCn),this.shipType="2",se.changeColor(e),this.$parent.$refs.shipListModel.activeKey="2",this.$parent.$refs.shipListModel.getFollowList()):this.$message.error(t.message)})},transformation(e,t){if(!e)return"-";switch(t){case"time":const t=new Date(e);return`${t.getFullYear()}-${t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1)}-${t.getDate()>=10?t.getDate():"0"+t.getDate()} ${t.getHours()>=10?t.getHours():"0"+t.getHours()}:${t.getMinutes()>=10?t.getMinutes():"0"+t.getMinutes()}:${t.getSeconds()>=10?t.getSeconds():"0"+t.getSeconds()}`;case"lon":return`${Math.floor(Math.abs(e)/1e4/60)}°${(Math.abs(e)-60*Math.floor(Math.abs(e)/1e4/60)*1e4)/1e4}′${e<0?"W":"E"}`;case"lat":return`${Math.floor(Math.abs(e)/1e4/60)}°${(Math.abs(e)-60*Math.floor(Math.abs(e)/1e4/60)*1e4)/1e4}′${e<0?"S":"N"}`;case"state":switch(e){case"0":return"发动机使用中";case"1":return"锚泊";case"2":return"未操纵";case"3":return"有限适航性";case"4":return"受船舶吃水限制";case"5":return"系泊";case"6":return"搁浅";case"7":return"从事捕捞";case"8":return"航行中";default:return"未定义"}default:return e}}}},he=de,pe=(a("856b"),Object(m["a"])(he,ce,le,!1,null,"e7db7090",null)),me=pe.exports,ue=function(){var e=this,t=e._self._c;return t("div",[t("a-popover",{attrs:{placement:"left",trigger:"click",getPopupContainer:t=>t.parentNode||e.document.body}},[t("template",{slot:"content"},[t("div",[t("div",{staticClass:"triangle-up",staticStyle:{"border-bottom":"19px solid lawngreen"}}),t("div",{staticStyle:{color:"lawngreen"}},[e._v("船队船舶")])]),t("div",[t("div",{staticClass:"triangle-up",staticStyle:{"border-bottom":"19px solid orange"}}),t("div",{staticStyle:{color:"orange"}},[e._v("关注船舶")])])]),t("div",{staticClass:"popcover"},[t("img",{attrs:{src:a("9405"),alt:""}})])],2)],1)},ge=[],ve={data(){return{}},created(){},mounted(){},methods:{}},fe=ve,we=(a("5d30"),Object(m["a"])(fe,ue,ge,!1,null,"02d71e79",null)),ye=we.exports,Ce=a("9d47"),ke={components:{SmallMap:_,shipListModel:oe,shipInfoModel:me,shipTips:ye},data(){return{map:null,spinning:!1,showVideoModel:!1,percent:0,progressName:""}},created(){},mounted(){setTimeout(()=>{this.map=se.creatMap(),se.addMousePos(this.map),this.map.addControl(new Ce["a"]),se.addClick(this.map,this),se.showShipPathMessage(this.map,this),this.getAisData(),this.map.updateSize()},1e3)},methods:{changeMap(e){se.changeMap(this.map,e)},getAisData(){this.$axios.get("/seachart/CurrentAis/getMyFleetCurrentAisData").then(e=>{se.addShip(e.result.data)}),this.$axios.get("/seachart/CurrentAis/getMyFocusCurrentAisData").then(e=>{se.addShip(e.result.data)})},refresh(){this.spinning=!0,this.getAisData(),this.$refs.shipListModel.getShipGroupList(),this.$refs.shipListModel.getFollowList(),setTimeout(()=>{this.spinning=!1},1e3)}},beforeDestroy(){this.map.getLayers().clear()},computed:{currentAnimate(){return this.$store.state.currentAnimate}}},Se=ke,_e=(a("d7c0"),Object(m["a"])(Se,v,f,!1,null,"24378cae",null)),be=_e.exports,Ie={components:{VideoModel:g,MapModel:be},data(){return{activeType:1,workTotalList:[],pageSize:20,pageNo:1,total:0,pages:0,loading:!1,pageSize1:20,pageNo1:1,total1:0,pages1:0,certificateList:[],urlList:[]}},created(){this.getWorkTotal(),this.getCertificateList(),this.getUrlList()},mounted(){},methods:{changeActiveType(e){this.activeType=e,this.pageNo1=1,this.getCertificateList()},getWorkTotal(){this.$axios.get("/pmsService/pmsShipWorkOrder/selectWorkOrderStatisticsNum",{params:{pageSize:this.pageSize,pageNo:this.pageNo}}).then(e=>{this.workTotalList=e.result.records,this.loading=!1,this.total=e.result.total,this.pages=e.result.pages})},getCertificateList(){let e;e="1"==this.activeType?"/shipService/shipUpload/list":"2"==this.activeType?"/shipService/seamanUpload/list":"/shipService/insuranceUpload/list",this.$axios.get(e,{params:{pageSize:this.pageSize,pageNo:this.pageNo}}).then(e=>{this.certificateList=e.result.records,this.total1=e.result.total,this.pages1=e.result.pages})},getUrlList(){this.$axios.get("/interface/tsSystemLink/list").then(e=>{"200"==e.code&&(this.urlList=e.result.records)})}}},De=Ie,Le=(a("a62a"),Object(m["a"])(De,s,i,!1,null,"19b9d7f8",null));t["default"]=Le.exports},"3d9d":function(e,t,a){"use strict";a("0ace")},"3df3":function(e,t,a){},"3e02":function(e,t,a){},"4a99":function(e,t,a){"use strict";a("3e02")},"5ab0":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAA6klEQVRIS+1WUQ6CMAxtF+UUyjecQjjZ4GTiKcRf9BRoVrPF4VgWAZdsicjnaPva9b21CAE/DIgF8cDa/fZoV0qIp7zrK3l+3m0KROTahojq/PZo1L80qZDoYPtn13upz0aVKTDEwnQggHoExtiQEAlRjsAAhkRUDKJmEizreu/rbdOEVgp2SRMuAFD3yEcWkjDS34zl3ZslCcUDkzpSpb+0syRr29YVy6mzP/U/XfOkqIP2zIcQc3wjUt+h+jkZu2wmXxA1kwB4EOr/PliQSa2bajfcXAuAsffaIERjrgUuoqxwxHyrqbl+T6V70Rx8GKTHAAAAAElFTkSuQmCC"},"5b08":function(e,t,a){},"5d30":function(e,t,a){"use strict";a("e30a")},6355:function(e,t,a){},"6fa5":function(e,t,a){"use strict";a("5b08")},"856b":function(e,t,a){"use strict";a("19b2")},9405:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAES0lEQVRYR+2WX0hbdxTHz7m5ilpH/iCWMZoqtN1ahWa5sbNDqAGXzgerQ8Y6+6DDvYzByDrmYDBmESaMwmrtQ8se1L3sqW3GBKEMdGNu1eRmdyuIbMRmXdlcE0lMotYk955xsmSIxCXXKnTDwCXhl9/vns/vfM8/hMfog48RC+zBbKXG/9MzzudOKEBEuVtHkimnoihRPTGp2zM2m60GAKKbDbU93xgcrTtw8NZSHK7cD89Mz/oa9YDwXl0wNpvNZDAYFFVVmxVFCW40dupEQ+SlaqMpsJYEf2ztwbTXu3/XYBoaGmxE1E1EZlmWezYaykJG2GOIOKRpWtTv91/aNRhJkkYRMUhEiizLno2GHA5Hs/HAIU9ppTESWZgLPVyJu/TGi26Z8t2UQYjIZLI+/Vnze5efCE5PrNy5fnWVUkmX1+tV9HhHV8zke7EkSVEicltqn7ly6t3L+3jP8v0AfP3xW6up5PpTejz0SDB2u70HEUcQ0Xnw5Is3bOfcZoYJTN6EkvJ9cOf6tbsP48v2YoEeCUaSJJahBhE7Dr/w8s1j7b0mhpm51g9VR47Danjxt8CU54Ysy+5i5No2TDZWRokoKAjC1CHXK+/UnXmtko2m1hIw+dEb0OS+CN9cdP+xHo90+Xy+qUJA24LJpvIPRHSBvYKIymHX2b5jZ3rKcwbv3b4F4V9+guqjDX/Ko4MzPp+vfVdgJEnK1BBOc0EQuCLDkdOvvn+0rbtko0EGsja64Mvz7aHZ76ardxwmG7SfqKpaK4riP7Hw7Lm3P7CePC2wN/6WagWiv/68pqWTiXszX5UnE8tthaTSLZMkSR6uK7lbGgwGNxF1ENGHZcaqeU1NJZFgCQWQ1xOxFU3TOKaC6XRaKZRVRcNwO1BVtaDuBaVA/HFzBc+dKRqG5bFYLFdbWlpKE4mEVlFRoRKRBgD8ZH5venJrxOuhUKjU6/XuR8QLPp+vPx900TB8uKmpaWlgYMAyPj4OTqcT6urqCjki8//Y2NiDiYmJylQq9abf7x/d6pAumM7Ozo5kMvm5y+Uqm5ubg76+voIwg4ODv8/Pz38fi8Ve35GYcTgc/USUiRdRFEusVuuTra2tFvbM8PDwYiAQMNXX10NXV1dZTU0m02F2dhZGRkbCoVCoioj6NU0bYhiuUQBg2jwPFdW1ebITRbEnnU5zbeHhivXuNpvNi6qqJuPxeDenbG9v79mFhYVPjUZjLBwOl4ii+G00Gj3PMw6XACLiGeguANQCgDtfEBclE5d+AMh4Jp1OD+W04dvZ7XY3Ih4HAJ5zhhie1/lbEIRuROTeNcapLYqi7d9qTUGY7Et5sLrE9QUR2TOT3JMQkbv2GABw3+G5poeIuIuzVk6WBxEzIwYiclZNISLv+yLfJFgQJl+EcpqzZJqmeTZqnwVv5iK32QNZ7zYjomeroWtbMAVTaJsb9mB2pOht0/tFH9uT6T8h01/Jbx9Chs3jHgAAAABJRU5ErkJggg=="},a62a:function(e,t,a){"use strict";a("3df3")},ac28:function(e,t,a){e.exports=a.p+"img/shipImg.6eac8d79.jpg"},ce75:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAQCAYAAAGthlVmAAAACXBIWXMAACxKAAAsSgF3enRNAAABIUlEQVQYlXWRPUtCcRTGf/7v/9LVEN8wlepWSi/0cinCMChwKXBpaajP0NIS9AFa2psahL5GSxg0Sd+gpiicwiEwzeJpKAvJnu2c5/Cc3+EgCTxry3jWxilVqnIkcVn3ZcKuWwYISQKAte0zxTP5TWOcCF4keWLoSRKpscX7YONIkrBh1y0vb50XAHL5Yu139Fv2tdutTS3tAPDWfrlCEp61k5K+AkuVqtJ+cGpSo/PXALHk3HFooXSgaGIVAOPYyE9i34q+wsF09jrtp3Tz+baDpB7vfraw/pjMzTZ6PQuQmVgJojH/IuvvDgEkctMPzcadbwBcL3bTMwBmgsPxRKZQN2HXLadGitE+CieCN5xs/bn+X9SB5sd7a6D5+5oB+gSc+l4haE5rKwAAAABJRU5ErkJggg=="},d7c0:function(e,t,a){"use strict";a("6355")},e30a:function(e,t,a){}}]);